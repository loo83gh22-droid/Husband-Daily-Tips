-- Remove Vulnerability Master badge and add Conflict Resolution Master (25 actions)

-- ============================================================================
-- STEP 1: Remove Vulnerability Master badge
-- ============================================================================

DELETE FROM badges 
WHERE name = 'Vulnerability Master'
OR (name ILIKE '%vulnerability master%')
OR (name ILIKE '%vulnerability%' AND requirement_value = 10);

-- ============================================================================
-- STEP 2: Ensure Conflict Resolution Master badge exists (25 actions)
-- ============================================================================

INSERT INTO badges (name, description, icon, badge_type, requirement_type, requirement_value, health_bonus, category)
SELECT 
  'Conflict Resolution Master',
  'Completed 25 conflict resolution actions. You''re a conflict resolution master.',
  '⚖️',
  'big_idea',
  'category_count',
  25,
  0,
  'Conflict Resolution'
WHERE NOT EXISTS (
  SELECT 1 FROM badges 
  WHERE name = 'Conflict Resolution Master'
  AND requirement_type = 'category_count'
  AND requirement_value = 25
  AND category = 'Conflict Resolution'
);

-- ============================================================================
-- STEP 3: Update comment
-- ============================================================================

COMMENT ON TABLE badges IS 'Conflict Resolution badges follow the standard progression: 1=Starter, 5=Builder, 10=Expert, 25=Master, 50=Champion, 100=Legend. All badge progressions follow consistent naming across all categories. Badges are awards and do NOT affect Husband Health score.';

